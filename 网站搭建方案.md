# 专升本学习系统网站搭建方案

## 一、项目概述

### 1.1 项目定位
专升本教学培训机构的学习管理系统，包含用户管理系统和学习测评系统两大核心模块。

### 1.2 技术栈选择
- **前端框架**: Next.js 14+ (App Router)
- **UI框架**: Tailwind CSS + Shadcn/ui
- **状态管理**: Zustand 或 React Context
- **数据库**: Vercel Postgres (或 Supabase)
- **认证**: NextAuth.js 或自定义JWT
- **API集成**: Deepseek API
- **部署平台**: Vercel

### 1.3 设计风格
- 主题：科技未来风
- 主色调：蓝色系（#0EA5E9, #3B82F6, #1E40AF等）
- 辅助色：渐变蓝、霓虹蓝、深蓝
- UI元素：卡片式设计、毛玻璃效果、渐变背景、动画过渡

---

## 二、系统架构设计

### 2.1 整体架构

```
┌─────────────────────────────────────┐
│         用户系统 (User System)      │
│  ┌─────────┬─────────┬──────────┐  │
│  │ 管理端  │ 教师端  │  学生端  │  │
│  └─────────┴─────────┴──────────┘  │
└─────────────────────────────────────┘
              │ (仅登录关系)
              ▼
┌─────────────────────────────────────┐
│       学习系统 (Learning System)     │
│  ┌──────────────────────────────┐  │
│  │  AI通关测 | AI错题本          │  │
│  │  AI精准练 | 学习计划          │  │
│  └──────────────────────────────┘  │
└─────────────────────────────────────┘
```

### 2.2 数据库设计

#### 2.2.1 用户系统数据库表

**admins (管理员表)**
- id: UUID (主键)
- password: VARCHAR (默认: admin888)
- created_at: TIMESTAMP

**teachers (教师表)**
- id: UUID (主键)
- username: VARCHAR (唯一)
- password: VARCHAR (加密存储)
- created_by_admin_id: UUID (外键 → admins.id)
- created_at: TIMESTAMP
- is_active: BOOLEAN (默认true，永久有效)

**students (学生表)**
- id: UUID (主键)
- username: VARCHAR (唯一)
- password: VARCHAR (加密存储)
- created_by_teacher_id: UUID (外键 → teachers.id)
- created_at: TIMESTAMP
- is_active: BOOLEAN (默认true，可被注销)
- deleted_at: TIMESTAMP (软删除标记)

**assignments (作业表)**
- id: UUID (主键)
- teacher_id: UUID (外键 → teachers.id)
- student_id: UUID (外键 → students.id)
- content: TEXT (作业内容)
- created_at: TIMESTAMP

#### 2.2.2 学习系统数据库表

**exam_reports (测评报告表)**
- id: UUID (主键)
- student_id: UUID (外键 → students.id，仅关联，不强制约束)
- subject: VARCHAR (大学语文/大学英语/高等数学/计算机基础)
- selected_path: JSONB (存储选择路径: {板块, 章, 节, 知识点})
- questions: JSONB (存储题目数据)
- answers: JSONB (存储学生答案)
- score: INTEGER (总分 0-100)
- created_at: TIMESTAMP

**注意**: 学习系统与用户系统数据库完全隔离，仅通过student_id进行逻辑关联。

---

## 三、功能模块详细设计

### 3.1 用户系统模块

#### 3.1.1 主页 (/)
- **布局**: 三个卡片横向排列
  - 学生端卡片（左侧）
  - 教师端卡片（中间）
  - 管理端卡片（右侧）
- **交互**: 点击卡片弹出对应登录弹窗

#### 3.1.2 管理端 (/admin)
- **登录验证**: 
  - 弹窗输入密码
  - 默认密码: `admin888`
  - 验证通过后进入管理端页面
  
- **功能页面**:
  1. **创建教师账号** (`/admin/create-teacher`)
     - 表单: 教师用户名、密码
     - 提交后创建教师账号（永久有效）
     
  2. **查看教师学生统计** (`/admin/teacher-stats`)
     - 列表展示所有教师
     - 每个教师显示其创建的学生账号数量
     - 格式: "教师A: 15个学生"

#### 3.1.3 教师端 (/teacher)
- **登录验证**:
  - 弹窗输入账号和密码
  - 验证账号是否存在且由管理端创建
  
- **功能页面**:
  1. **创建学生账号** (`/teacher/create-student`)
     - 表单: 学生用户名、密码
     - 提交后创建学生账号
     - 提供注销功能（软删除，数据永久删除）
     
  2. **查看学生测评报告** (`/teacher/reports`)
     - 下拉选择学生账号
     - 展示该学生所有历史测评报告
     - 可查看详细报告内容
     
  3. **布置作业** (`/teacher/assignments`)
     - 选择目标学生
     - 输入作业内容
     - 发送到学生端"学习计划"

#### 3.1.4 学生端登录 (/student/login)
- **登录验证**:
  - 弹窗输入账号和密码
  - 验证账号是否存在且由教师端创建
  - 验证通过后进入学习系统主页

---

### 3.2 学习系统模块

#### 3.2.1 学习系统主页 (/student/dashboard)
- **布局比例**: 3:4:3 (左:中:右)
- **左侧板块**:
  - 上: "AI通关测" 卡片
  - 下: "AI错题本" 卡片
- **中间板块**:
  - 立体熊猫卡通形象
  - 上方文字: "AI智习室"
  - 遵循黄金比例布局
- **右侧板块**:
  - 上: "AI精准练" 卡片 (暂未上线)
  - 下: "学习计划" 卡片

#### 3.2.2 AI通关测模块 (/student/exam)

**学科选择页** (`/student/exam`)
- 四个卡片: 大学语文、大学英语、高等数学、计算机基础

**流程选择页** (`/student/exam/[subject]/select`)
- **大学语文**: `/student/exam/chinese/select`
  - 步骤1: 选择板块
  - 步骤2: 选择章
  - 步骤3: 选择节
  - 步骤4: 选择知识点
  - 数据源: `chinese_exam_nodes.json`
  
- **大学英语**: `/student/exam/english/select`
  - 步骤1: 选择板块
  - 步骤2: 选择部分
  - 步骤3: 选择章
  - 步骤4: 选择节
  - 步骤5: 选择知识点
  - 数据源: `english_exam_nodes.json`
  
- **高等数学**: `/student/exam/math/select`
  - 步骤1: 选择章
  - 步骤2: 选择节
  - 步骤3: 选择知识点
  - 数据源: `math_exam_nodes.json`
  
- **计算机基础**: `/student/exam/computer/select`
  - 步骤1: 选择章
  - 步骤2: 选择节
  - 步骤3: 选择知识点
  - 数据源: `computer_exam_nodes.json`

**答题流程** (`/student/exam/[subject]/quiz`)
1. **题目生成**:
   - 点击"开始答题"按钮
   - 调用Deepseek API生成10道单选题
   - 显示加载状态
   
2. **答题界面** (`/student/exam/[subject]/quiz/[questionId]`):
   - 一题一页
   - 显示题目和A/B/C/D四个选项
   - 右下角"下一题"按钮
   - 最后一题显示"提交"按钮
   
3. **评分与报告**:
   - 提交后自动评分（每题10分，共100分）
   - 显示"正在阅卷"过渡页
   - 生成测评报告页面 (`/student/exam/[subject]/report/[reportId]`)
   - 报告内容:
     - 总成绩
     - 每道题目的作答情况（正确/错误）
     - 每道题目的解析
   - 保存到AI错题本
   - 提供返回按钮

#### 3.2.3 AI错题本模块 (/student/notebook)
- 列表展示所有历史测评报告
- 可按学科筛选
- 点击查看详细报告
- 显示测评时间、学科、知识点、得分

#### 3.2.4 学习计划模块 (/student/assignments)
- 展示教师端发送的作业信息
- 按时间倒序排列
- 显示作业内容和发送时间

#### 3.2.5 AI精准练模块
- 点击无反应
- Hover提示: "此功能暂未上线，敬请期待"

---

## 四、Deepseek API集成设计

### 4.1 API调用流程

```
学生选择知识点 
  ↓
构建Prompt (包含学科、完整知识点路径)
  ↓
调用Deepseek API
  ↓
解析返回的JSON格式题目
  ↓
存储到数据库
  ↓
开始答题流程
```

### 4.2 Prompt设计模板

```javascript
const prompt = `
你是一位专业的专升本考试出题专家。现在需要你为${subject}科目出题。

知识点信息：
${JSON.stringify(selectedPath, null, 2)}

请严格按照以下要求出题：
1. 出10道单选题
2. 每道题必须包含：
   - 题目内容
   - A、B、C、D四个选项
   - 正确答案（A/B/C/D中的一个）
   - 详细解析

3. 题目难度适中，符合专升本考试水平
4. 题目必须与所选知识点紧密相关

请以以下JSON格式返回：
{
  "questions": [
    {
      "id": 1,
      "question": "题目内容",
      "options": {
        "A": "选项A",
        "B": "选项B",
        "C": "选项C",
        "D": "选项D"
      },
      "correctAnswer": "A",
      "explanation": "详细解析内容"
    },
    ...
  ]
}
`;
```

### 4.3 API配置
- **API Key**: `sk-7586d9f6564d40328f886b8f0b0fef1c`
- **Base URL**: `https://api.deepseek.com/v1/chat/completions`
- **Model**: `deepseek-chat`
- **Temperature**: 0.7 (保证题目多样性)
- **Max Tokens**: 4000 (确保完整返回10道题)

### 4.4 错误处理
- API调用失败: 显示错误提示，允许重试
- 返回格式错误: 尝试解析，失败则重新请求
- 网络超时: 设置30秒超时，超时后提示重试

---

## 五、路由设计

```
/                          # 主页（三个卡片）
/admin                     # 管理端主页
/admin/create-teacher      # 创建教师账号
/admin/teacher-stats       # 教师学生统计
/teacher                   # 教师端主页
/teacher/create-student    # 创建学生账号
/teacher/reports           # 查看学生报告
/teacher/assignments       # 布置作业
/student/dashboard         # 学习系统主页
/student/exam              # 学科选择
/student/exam/[subject]/select    # 知识点选择流程
/student/exam/[subject]/quiz      # 答题流程
/student/exam/[subject]/report/[id]  # 测评报告
/student/notebook          # AI错题本
/student/assignments       # 学习计划
```

---

## 六、安全设计

### 6.1 认证机制
- 管理端: 密码验证（session存储）
- 教师端: 账号密码验证（JWT token）
- 学生端: 账号密码验证（JWT token）

### 6.2 数据安全
- 密码使用bcrypt加密存储
- API密钥存储在环境变量中
- 数据库连接使用SSL
- 防止SQL注入（使用参数化查询）

### 6.3 权限控制
- 管理端只能访问管理端路由
- 教师端只能访问教师端路由和学生数据
- 学生端只能访问学习系统路由和自己的数据

---

## 七、UI/UX设计要点

### 7.1 科技未来风设计元素
- **背景**: 深蓝渐变背景 (#0F172A → #1E293B)
- **卡片**: 毛玻璃效果 (backdrop-blur) + 蓝色边框
- **按钮**: 霓虹蓝发光效果 (box-shadow)
- **文字**: 渐变文字效果
- **动画**: 平滑过渡动画 (transition, transform)

### 7.2 交互反馈
- 按钮hover效果
- 加载状态提示
- 成功/错误提示（Toast通知）
- 页面切换动画

### 7.3 响应式设计
- 移动端适配（优先考虑桌面端）
- 最小宽度: 1200px（保证功能完整性）

---

## 八、技术实现细节

### 8.1 数据加载策略
- JSON文件作为静态数据，直接导入
- 数据库查询使用服务端组件
- API调用使用服务端API Route

### 8.2 状态管理
- 答题进度: 使用URL参数或localStorage
- 用户登录状态: 使用Cookies/Session
- 全局UI状态: React Context

### 8.3 性能优化
- 图片使用Next.js Image组件
- API响应缓存
- 数据库查询优化（索引）

---

## 九、部署方案

### 9.1 Vercel部署配置
- 使用Vercel Postgres数据库
- 环境变量配置:
  - `DEEPSEEK_API_KEY`
  - `DATABASE_URL`
  - `NEXTAUTH_SECRET`

### 9.2 构建优化
- 生产环境代码压缩
- 静态资源CDN加速
- 数据库连接池配置

---

## 十、开发计划

### Phase 1: 基础架构
1. Next.js项目初始化
2. 数据库设计和创建
3. 基础UI组件库搭建
4. 路由结构搭建

### Phase 2: 用户系统
1. 管理端功能实现
2. 教师端功能实现
3. 学生端登录功能
4. 认证系统集成

### Phase 3: 学习系统
1. 学习系统主页
2. AI通关测流程实现
3. Deepseek API集成
4. 答题和评分系统
5. 测评报告生成

### Phase 4: 辅助功能
1. AI错题本
2. 学习计划（作业接收）
3. 数据统计功能

### Phase 5: 优化与测试
1. UI美化
2. 性能优化
3. 错误处理完善
4. 测试与修复

---

## 十一、注意事项

1. **数据隔离**: 用户系统和学习系统数据库完全隔离，仅通过student_id逻辑关联
2. **账号管理**: 教师账号永久有效，学生账号可注销且数据永久删除
3. **API稳定性**: Deepseek API调用需要完善的错误处理和重试机制
4. **功能优先级**: 功能性 > 美观性，确保所有功能稳定可用
5. **返回机制**: 每个页面都需要返回按钮，保证导航流畅

---

## 十二、文件结构

```
exam/
├── app/
│   ├── (auth)/
│   │   ├── admin/
│   │   ├── teacher/
│   │   └── student/
│   ├── student/
│   │   ├── dashboard/
│   │   ├── exam/
│   │   ├── notebook/
│   │   └── assignments/
│   └── api/
│       └── deepseek/
├── components/
│   ├── ui/
│   ├── auth/
│   └── exam/
├── lib/
│   ├── db.ts
│   ├── auth.ts
│   └── deepseek.ts
├── data/
│   ├── chinese_exam_nodes.json
│   ├── english_exam_nodes.json
│   ├── math_exam_nodes.json
│   └── computer_exam_nodes.json
├── public/
└── types/
```

---

此方案涵盖了所有需求点，确保功能完整性和系统稳定性。请确认后开始代码实现。
