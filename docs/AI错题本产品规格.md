# AI错题本 产品规格说明

> 与测评报告、AI通关测完全隔离。存储单位为「错题」，错题本仅为分类容器。

---

## 一、数据与结构

### 1.1 实体关系

| 实体 | 说明 | 关系 |
|------|------|------|
| **错题本** | 分类容器，类似文件夹 | 并列关系，不可嵌套；仅主页可新建 |
| **错题** | 存储单位，含题目文本与命名 | 一个错题只属于一个错题本或未归类 |

- **未归类**：允许。错题可不放入任何错题本，显示在主页「未归类」区域。
- **归属**：一个错题只能属于一个错题本（拖拽为移动，非复制/引用）。

### 1.2 命名建议（系统提示）

- 错题本：某类错题的名字（如「二次函数」「定语从句」）。
- 错题：该题主要相关知识点。

### 1.3 列表与排序

- 错题本列表、错题列表：**支持自定义排序**，以**美观优先**（如拖拽排序）。

---

## 二、页面与入口

### 2.1 入口

- 学生端点击「AI错题本」卡片 → 进入 **AI错题本主页**。

### 2.2 AI错题本主页

- **展示**：错题本列表 + 未归类错题区域（若有）。
- **操作**：
  - **右击空白**：创建错题本 / 创建错题。
  - **右击错题本**：重命名、删除（需二次确认）。
  - **右击错题**：重命名、删除（需二次确认）。
  - **点击错题本**：进入该错题本内页。
  - **拖拽错题**：可将错题拖入任意错题本（移动，非复制）。

### 2.3 错题本内页

- **展示**：该错题本下的错题列表；若无错题则内容为空。
- **操作**：
  - 可**新建错题**（不可新建错题本）。
  - 右击空白：创建错题。
  - 右击错题：重命名、删除（需二次确认）。
  - 点击错题：打开错题详情弹窗。
  - **导出错题本**：将当前错题本内的**错题本身**（题目名称、题目文本等）导出为文件（格式见下）。

---

## 三、导出错题本

- **触发**：在错题本内页提供「导出错题本」入口（如按钮或右击错题本菜单）。
- **导出内容**：仅导出**错题本身**——即该错题本下所有错题的题目名称（知识点）、题目完整文本等，不包含 AI 分析结果、举一反三题目等未存储内容。
- **建议格式**：由实现时确定（如 TXT、Markdown、PDF 等），便于学生复习与打印；文件名可含错题本名称与导出时间。

---

## 四、创建与编辑

### 4.1 创建错题本

- 类似新建文件夹：**直接创建**，无多步向导。
- 创建后可重命名（右击 → 重命名）。

### 4.2 创建错题（弹窗）

两种方式二选一：

**方式一：上传图片**

1. 上传错题图片 → 下一步。
2. 调用 **百度智能云 OCR** 提取文本；支持重试或切换为手动编辑。
3. 用户编辑识别结果 → 确认保存。
4. 保存后同一弹窗内显示：大按钮「分析错题」「举一反三」+ 小按钮「关闭」。

**方式二：手动输入**

1. 直接编辑题目文本 → 保存。
2. 保存后同一弹窗内显示：「AI分析」「举一反三」「关闭」。

（「分析错题」与「AI分析」为同一能力，统一为 **AI分析** 亦可。）

### 4.3 查看/编辑已存在错题

- 点击某错题 → 弹窗展示**已保存题目内容**。
- 弹窗内：左侧大按钮「**AI分析**」、右侧大按钮「**举一反三**」、右上角「**关闭**」。
- 支持**编辑错题**（含重命名、修改题目文本）；删除通过右击菜单，需二次确认。

---

## 五、AI 能力（均不落库，仅即时展示）

### 5.1 AI 分析

- 将当前错题保存的**题目完整文本**发送给 **DeepSeek**，请求完整、详细解析。
- 请求完成后**新弹窗**展示：题目 + 详细解析。
- **不存储**解析结果。

### 5.2 举一反三

- 将当前错题发送给 **DeepSeek**，请求 3 道**同类型、单选题**题目及解析。
- 请求完成后弹出**答题弹窗**：3 道单选题，用户作答。
- **系统自动判断**对错；作答结束后展示：每道题正确/错误 + 每道题详细解析。
- 题目、作答、解析**均不存储**。

---

## 六、弹窗与导航

- 所有业务弹窗均支持：
  - **关闭**：关闭当前弹窗回到上一层或列表。
  - **返回上一级**：在多级弹窗时可返回上一级弹窗（不关聊天窗口）。
- 弹窗层级示例：列表 → 错题详情 → AI分析结果 / 举一反三答题与结果。

---

## 七、全局悬浮按钮（AI错题本内全局）

- **作用**：实时 AI 对话，与 DeepSeek 对话。
- **展示**：AI错题本主页、错题本内页等所有 AI错题本相关页面均显示。
- **交互**：
  - **快速单击**：打开/关闭聊天窗口。
  - **长按并拖动**：移动按钮位置（长按不触发打开聊天）。
- **上下文**：聊天**不带**当前错题上下文，纯自由对话。

---

## 八、技术依赖

| 能力 | 实现方式 |
|------|----------|
| OCR | 百度智能云 OCR |
| 解析 / 举一反三 / 对话 | DeepSeek API |

---

## 九、功能清单速查

| 项目 | 说明 |
|------|------|
| 未归类错题 | 允许，主页展示未归类区域 |
| 错题归属 | 一题一本，拖拽为移动 |
| 错题本嵌套 | 不允许，仅主页可新建错题本 |
| 删除/重命名 | 支持；删除需二次确认 |
| 编辑错题内容 | 支持（含重命名、改题目文本） |
| **导出错题本** | 导出该错题本内**错题本身**（名称、题目文本等），不包含 AI 分析/举一反三等未存储内容 |
| 分析按钮 | 统一为「AI分析」 |
| 举一反三题型 | 单选题，系统自动判题 |
| 悬浮按钮 | 单击打开聊天，长按拖动移动 |
| 聊天上下文 | 不带当前错题 |
| OCR 失败 | 允许重试或切换手动编辑 |
| 列表排序 | 自定义，美观优先 |
| 右击菜单 | 空白：创建；错题本/错题：重命名、删除 |

---

*文档版本：1.0 | 与需求确认一致*
